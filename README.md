# Παράλληλες Αρχιτεκτονικές Υπολογισμού για Μηχανική Μάθηση

## Εξαμηνιαία Εργασία: Παραλληλοποίηση και Βελτιστοποίηση Εκπαίδευσης Νευρωνικού Δικτύου

Αυτό το αποθετήριο περιέχει την υλοποίηση και τα αποτελέσματα της εξαμηνιαίας εργασίας για το μάθημα "Παράλληλες Αρχιτεκτονικές Υπολογισμού για Μηχανική Μάθηση" του Δ.Π.Μ.Σ. "Επιστήμη Δεδομένων και Μηχανική Μάθηση" του Εθνικού Μετσόβιου Πολυτεχνείου.

---

### 1. Σκοπός της Εργασίας

Σκοπός της εργασίας είναι η μελέτη, παραλληλοποίηση και βελτιστοποίηση της εκπαίδευσης ενός νευρωνικού δικτύου (Multi-Layer Perceptron) για την αναγνώριση χειρόγραφων ψηφίων από τη βάση δεδομένων MNIST. Η ανάλυση εστιάζει στον πιο υπολογιστικά απαιτητικό πυρήνα της εκπαίδευσης, τον πολλαπλασιασμό πινάκων (General Matrix Multiply - GEMM), με στόχο την επίτευξη της μέγιστης δυνατής επιτάχυνσης.

Η εργασία περιλαμβάνει:
*   Παράλληλη υλοποίηση του GEMM σε **CPU** με `multiprocessing`.
*   Βελτιστοποίηση του GEMM σε **GPU** με `numba.cuda`, εξερευνώντας τεχνικές όπως το memory coalescing και η χρήση shared memory.
*   Ενσωμάτωση των βελτιστοποιημένων πυρήνων στην πλήρη ροή εκπαίδευσης ενός νευρωνικού δικτύου και αξιολόγηση της τελικής απόδοσης.

---

### 2. Δομή του Αποθετηρίου

Το αποθετήριο είναι οργανωμένο ως εξής:

*   `/report`: Περιέχει την τελική αναφορά της εργασίας σε μορφή PDF.
*   `/CudaGPU`: Ο πηγαίος κώδικας για τις υλοποιήσεις του GEMM σε GPU (`Simple`, `Transpose`, `SharedMem`).
*   `/Multiprocessing`: Ο πηγαίος κώδικας για την παράλληλη υλοποίηση του GEMM σε CPU.
*   `/Sequential`: Η αρχική, σειριακή υλοποίηση του GEMM που χρησιμοποιήθηκε ως baseline.
*   `/plotFiles`:
    *   `/Plots`: Οι εικόνες των γραφημάτων που παράχθηκαν.
    *   `/Plot Scripts`: Τα Python scripts που χρησιμοποιήθηκαν για τη δημιουργία των γραφημάτων.
    *   `*.csv`: Τα αρχεία δεδομένων με τα αποτελέσματα των πειραμάτων.
*   `/results`: Τα αρχεία εξόδου `.out` όπως παράχθηκαν από την εκτέλεση στο υπολογιστικό cluster.
*   `nn.py` & `utilities.py`: Ο κώδικας του νευρωνικού δικτύου και βοηθητικές συναρτήσεις.
*   `test*.py` & `run*.sh`: Τα scripts εκτέλεσης των πειραμάτων και υποβολής τους στο σύστημα ουρών Torque.
*   `mnistDataset.npz`: Το σύνολο δεδομένων MNIST.

---

### 3. Αναπαραγωγή Αποτελεσμάτων

Όλα τα πειράματα και οι μετρήσεις απόδοσης πραγματοποιήθηκαν στο υπολογιστικό cluster του Εργαστηρίου Υπολογιστικών Συστημάτων του ΕΜΠ, σε έναν κόμβο με 2x Intel Xeon Silver 4114 CPUs και 1x NVIDIA Tesla V100 GPU. Η υποβολή των εργασιών έγινε μέσω του συστήματος ουρών **Torque**.

1.  **Εκτέλεση Πειραμάτων CPU:**
    ```bash
    qsub runMultiprocessingMatMul.sh
    ```
2.  **Εκτέλεση Πειραμάτων GPU (GEMM):**
    ```bash
    qsub runCUDAMatMul.sh
    ```
3.  **Εκτέλεση Πειραμάτων Νευρωνικού Δικτύου:**
    ```bash
    qsub runNNWithCustomMatMul.sh
    ```
4.  **Δημιουργία Γραφημάτων:**
    Τo jupyter notebook στον φάκελο `/plotFiles/Plot Scripts` μπορεί να εκτελεστεί για να δημιουργήσουν τα γραφήματα από τα αντίστοιχα αρχεία `.csv`.

---
